LAMMPS (28 Mar 2023 - Development)
  using 1 OpenMP thread(s) per MPI task
# 2d rounded polygon bodies

variable    r     index 4
variable    steps index 100000
variable    T     index 0.5
variable    P     index 0.1
variable    seed  index 980411

units       lj
dimension   2

atom_style  body rounded/polygon 1 6
atom_modify map array
read_data   data.squares
Reading data file ...
  orthogonal box = (0 0 -0.5) to (12 12 0.5)
  2 by 2 by 1 MPI processor grid
  reading atoms ...
  2 atoms
  2 bodies
  read_data CPU = 0.001 seconds

replicate   $r $r 1
replicate   4 $r 1
replicate   4 4 1
Replication is creating a 4x4x1 = 16 times larger system...
  orthogonal box = (0 0 -0.5) to (48 48 0.5)
  2 by 2 by 1 MPI processor grid
  32 atoms
  replicate CPU = 0.001 seconds

velocity    all create $T ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 ${seed} dist gaussian mom yes rot yes
velocity    all create 0.5 980411 dist gaussian mom yes rot yes

variable cut_inner  equal 0.5
variable k_n        equal 100
variable k_na       equal 2
variable c_n        equal 1
variable c_t        equal 1
variable mu         equal 0.1
variable delta_ua   equal 0.5

pair_style body/rounded/polygon ${c_n} ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 ${c_t} ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 ${mu} ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 ${delta_ua} ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 ${cut_inner}
pair_style body/rounded/polygon 1 1 0.1 0.5 0.5
pair_coeff * * ${k_n} ${k_na}
pair_coeff * * 100 ${k_na}
pair_coeff * * 100 2

comm_modify vel yes

neighbor     0.5 bin
neigh_modify every 1 delay 0 check yes

timestep     0.001

#fix         1 all nve/body
#fix         1 all nvt/body temp $T $T 1.0
fix          1 all npt/body temp $T $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 $T 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 $P 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 $P 1.0 couple xy fixedpoint 0 0 0
fix          1 all npt/body temp 0.5 0.5 1.0 x 0.001 0.1 1.0              y 0.001 0.1 1.0 couple xy fixedpoint 0 0 0

fix          2 all enforce2d

#compute      1 all body/local id 1 2 3
#dump         1 all local 100000 dump.polygon.* index c_1[1] c_1[2] c_1[3] c_1[4]

thermo_style custom step ke pe etotal press
thermo       1000

#dump	     2 all image 10000 image.*.jpg type type zoom 2.0 #             adiam 1.5 body type 0 0
#dump_modify  2 pad 6

run          ${steps}
run          100000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.1568542
  ghost atom cutoff = 6.1568542
  binsize = 3.0784271, bins = 16 16 1
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair body/rounded/polygon, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/2d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 5.379 | 5.379 | 5.379 Mbytes
   Step         KinEng         PotEng         TotEng         Press     
         0   0.484375       0.25           0.734375       0.0067274306 
      1000   0.39720235     0.0015845731   0.39878692     0.00223489   
      2000   0.42893425     0.011718891    0.44065314     0.0027413224 
      3000   0.57823511     0.012407489    0.5906426      0.0025306081 
      4000   0.71610647     0.028149437    0.74425591     0.0016504948 
      5000   0.84027279     0.018917017    0.8591898      0.0037451875 
      6000   0.72410001     0.073495378    0.79759539     0.00018672875
      7000   0.53886484     0.077723366    0.61658821     0.004729216  
      8000   0.66196054     0.05502242     0.71698296     0.0054997327 
      9000   0.93104065     0.071628784    1.0026694      0.011330629  
     10000   0.75494389     0.15204106     0.90698496     0.021702127  
     11000   0.72349155     0.11102332     0.83451487     0.019264192  
     12000   0.56216536     0.11705898     0.67922434    -0.028296196  
     13000   0.63793556     0.11701866     0.75495421     0.029469295  
     14000   0.62999448     0.020866813    0.65086129     0.008609569  
     15000   0.6404504      0.0090011224   0.64945152     0.01706906   
     16000   0.70195749     0.044735201    0.74669269     0.0179597    
     17000   0.69097976     0.03894214     0.72992191     0.015704476  
     18000   0.75303457     0.0019263825   0.75496095     0.021536711  
     19000   0.6459718      0.10419136     0.75016317     0.033861092  
     20000   0.73026363     0.13023974     0.86050337     0.022207497  
     21000   0.77107035     0.30464112     1.0757115      0.013967631  
     22000   0.44134768     0.22883887     0.67018655     0.014202518  
     23000   0.53410601     0.16702381     0.70112983     0.009305779  
     24000   0.5144312      0.19041122     0.70484242    -0.0059836303 
     25000   0.60922681     0.15475207     0.76397888     0.016370526  
     26000   0.70922367     0.25374443     0.9629681      0.027301754  
     27000   0.67289133     0.39287626     1.0657676      0.025562031  
     28000   0.62112601     0.017177715    0.63830372     0.018556767  
     29000   0.56492546     0.087573524    0.65249898     0.025132036  
     30000   0.62612507    -0.01835118     0.60777389     0.050139664  
     31000   0.69157641     0.064849873    0.75642628     0.033954585  
     32000   0.72648211     0.08597545     0.81245756     0.038082388  
     33000   0.58608821     0.13013111     0.71621932     0.054766043  
     34000   0.49330983     0.080490598    0.57380043     0.034154681  
     35000   0.54570666     0.075020466    0.62072713     0.03879264   
     36000   0.60305736     0.10717781     0.71023516     0.030701059  
     37000   0.52801767     0.12516316     0.65318083     0.007411688  
     38000   0.5838277      0.12569072     0.70951842     0.03272916   
     39000   0.53999819     0.043261294    0.58325949     0.084115917  
     40000   0.64957099     0.040023268    0.68959426     0.027021958  
     41000   0.59235949     0.10449793     0.69685742     0.045773377  
     42000   0.71752786     0.043289363    0.76081722     0.040926021  
     43000   0.78581005     0.024363927    0.81017398     0.034694164  
     44000   0.6396541      0.06004252     0.69969662     0.037227348  
     45000   0.35753293     0.11456039     0.47209332     0.033569048  
     46000   0.11031158     0.11831834     0.22862991     0.076545681  
     47000   0.11720754     0.035471414    0.15267896     0.022093929  
     48000   0.13370328     0.031802339    0.16550562     0.053298269  
     49000   0.2700883      0.15584422     0.42593252     0.057108168  
     50000   0.53837779     0.13398219     0.67235998     0.047704986  
     51000   0.38133073     0.011372933    0.39270366     0.04696367   
     52000   0.32448241     0.009137008    0.33361942     0.033573259  
     53000   0.25798301    -0.016530605    0.2414524      0.04623663   
     54000   0.2842707      0.054504088    0.33877479     0.03751156   
     55000   0.28895106     0.025307766    0.31425882     0.03935955   
     56000   0.19130753     0.099678989    0.29098652     0.051888728  
     57000   0.12237303     0.057536458    0.17990949     0.09984021   
     58000   0.17962003     0.012450682    0.19207072     0.028644351  
     59000   0.21667262    -0.013693164    0.20297945     0.048086277  
     60000   0.4298123     -0.012970819    0.41684148     0.019347498  
     61000   0.69591654    -0.027048452    0.66886809     0.069793861  
     62000   1.0040382     -0.044228622    0.95980957     0.056563167  
     63000   0.78189663    -0.053045577    0.72885106     0.059491526  
     64000   0.57051419    -0.050757181    0.51975701     0.061863162  
     65000   0.62584243    -0.050616328    0.5752261      0.068924362  
     66000   0.85558894    -0.051396155    0.80419278     0.059309337  
     67000   0.86314978    -0.052635701    0.81051408     0.071855924  
     68000   0.65427495    -0.05147951     0.60279544     0.064001735  
     69000   0.60658011    -0.050623824    0.55595629     0.0715805    
     70000   0.76353932    -0.050863795    0.71267553     0.06771349   
     71000   0.87559332    -0.051720153    0.82387317     0.071884106  
     72000   0.71924774    -0.051167456    0.66808029     0.071010747  
     73000   0.6100998     -0.050025233    0.56007457     0.073319802  
     74000   0.71838075    -0.049907287    0.66847346     0.07314982   
     75000   0.91863251    -0.051069435    0.86756308     0.07493433   
     76000   0.78459189    -0.050803207    0.73378868     0.075397431  
     77000   0.70827012    -0.049701237    0.65856888     0.076901086  
     78000   0.72333497    -0.04940986     0.67392511     0.077456938  
     79000   0.76543474    -0.049588137    0.7158466      0.078792278  
     80000   0.77759003    -0.049596899    0.72799313     0.079470668  
     81000   0.67474562    -0.048929658    0.62581596     0.080740407  
     82000   0.60162355    -0.047698966    0.55392459     0.081758686  
     83000   0.7602675     -0.047827179    0.71244032     0.082547083  
     84000   0.9061851     -0.049481366    0.85670374     0.083443845  
     85000   0.74071256    -0.048645397    0.69206717     0.084605474  
     86000   0.67634638    -0.046894309    0.62945207     0.085608904  
     87000   0.71669859    -0.046524067    0.67017453     0.086561551  
     88000   0.77025498    -0.047090994    0.72316398     0.087515495  
     89000   0.76590655    -0.047083362    0.71882319     0.088522842  
     90000   0.61372503    -0.045529779    0.56819526     0.08963777   
     91000   0.58583927    -0.043777544    0.54206173     0.093090208  
     92000   0.80507421    -0.04423346     0.76084075     0.093861418  
     93000   0.84631942    -0.046878171    0.79944125     0.093279847  
     94000   0.70915593    -0.04570489     0.66345104     0.092425564  
     95000   0.66813988    -0.043460537    0.62467934     0.093467021  
     96000   0.71739316    -0.042402374    0.67499079     0.095183179  
     97000   0.74132854    -0.042457291    0.69887124     0.096665917  
     98000   0.74033914    -0.042269007    0.69807013     0.097869908  
     99000   0.72447372    -0.041519159    0.68295457     0.098825459  
    100000   0.6968193     -0.040321034    0.65649827     0.099797629  
Loop time of 2.55809 on 4 procs for 100000 steps with 32 atoms

Performance: 3377521.712 tau/day, 39091.686 timesteps/s, 1.251 Matom-step/s
91.9% CPU use with 4 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.53547    | 0.78258    | 1.0169     |  21.0 | 30.59
Neigh   | 0.0010868  | 0.0011973  | 0.0013608  |   0.3 |  0.05
Comm    | 0.57019    | 0.78963    | 1.0091     |  19.2 | 30.87
Output  | 0.00075581 | 0.0030547  | 0.0098741  |   7.1 |  0.12
Modify  | 0.80723    | 0.81855    | 0.83849    |   1.3 | 32.00
Other   |            | 0.1631     |            |       |  6.37

Nlocal:              8 ave          12 max           2 min
Histogram: 1 0 0 0 0 0 1 0 1 1
Nghost:          15.25 ave          19 max          13 min
Histogram: 1 1 0 1 0 0 0 0 0 1
Neighs:             12 ave          18 max           1 min
Histogram: 1 0 0 0 0 0 0 1 1 1

Total # of neighbors = 48
Ave neighs/atom = 1.5
Neighbor list builds = 1420
Dangerous builds = 0
Total wall time: 0:00:02
